Solutions:

Java:


Stage 3:

